extends layout

block content
	//- h1= title
	//- p Welcome to #{title}
	//- p What is up
	div.row
		div.col-md-6.centered.text-center
			img(src="/img/logo.png", width="200px")
			br
			if (req.isAuthenticated())
				h1= req.user.username
				a(href='/logout') logout 
				a(href='/ask') ask
			else
				a(href='/signup') signup 
				a(href='/login') login 
				a(href='/auth/facebook') facebook
			div#questionContainer 
				each question, index in questions
					div.row
						div.col-md-3.text-right
							img.img-rounded.img-random(src="/img/p"+index+".jpg", width="70px", id=index)
						div.col-md-9.text-left.question
							- var type = question.multiple ? 'checkbox' : 'radio'
							h3.topfix= question.question
							//- p= 'author: ' + question.authorId.username
							- if(question.answers.length)
								each answer in question.answers
									input(type=type, name=question._id)
									= ' ' + answer.answer
									br 

block scripts
	script(src="/socket.io/socket.io.js")
	script(type='text/javascript').
		var socket = io.connect('http://localhost:3000');
		// on document ready
		$(function(){
			$('#questionContainer').on('click', '#questionContainer input', function(){
				socket.emit('answer', {})
			})
			$(".img-random").attr("src", 
				function(i, val){
				var hello = Math.floor(Math.random()*7)+1);
				return "/img/p4.jpg"
				// return val+"/img/p"+hello.toString()+".jpg"
			});
		});
		$('body').on('change','#add input', function(){
			$(this).attr('name', 'answer['+number+']')
			$("#add span").text('Answer '+number);
			number++;
			var total='<div id="add"><span>Add Answer</span><input type="text" class="form-control"></div>';

			$("#add").after(total).removeAttr('id');
		})